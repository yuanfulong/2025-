{% extends "base.html" %}

{% block title %}ç»Ÿè®¡ä¿¡æ¯ - æ ¡å›­å¤±ç‰©æ‹›é¢†å¹³å°{% endblock %}

{% block content %}
<div class="page-title">
    <h2>ç»Ÿè®¡ä¿¡æ¯</h2>
    <p>æŸ¥çœ‹å¹³å°æ•°æ®ç»Ÿè®¡ï¼Œäº†è§£å¤±ç‰©æ‹›é¢†æƒ…å†µ ğŸ“Š</p>
</div>

<!-- æ€»ä½“ç»Ÿè®¡ -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%); color: #721c24; border: none;">
        <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ”</div>
        <h3 style="font-size: 2rem; margin-bottom: 0.5rem;">{{ total_lost }}</h3>
        <p style="font-size: 1.1rem; font-weight: 500;">é—å¤±ç‰©å“</p>
    </div>
    
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); color: #155724; border: none;">
        <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ“¦</div>
        <h3 style="font-size: 2rem; margin-bottom: 0.5rem;">{{ total_found }}</h3>
        <p style="font-size: 1.1rem; font-weight: 500;">æ‹¾åˆ°ç‰©å“</p>
    </div>
    
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
        <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ“ˆ</div>
        <h3 style="font-size: 2rem; margin-bottom: 0.5rem;">{{ total_lost + total_found }}</h3>
        <p style="font-size: 1.1rem; font-weight: 500;">æ€»è®¡ä¿¡æ¯</p>
    </div>
    
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); color: #8b4513; border: none;">
        <div style="font-size: 3rem; margin-bottom: 0.5rem;">ğŸ¯</div>
        <h3 style="font-size: 2rem; margin-bottom: 0.5rem;">
            {% if total_lost > 0 %}{{ "%.1f"|format((total_found / (total_lost + total_found) * 100)) }}%{% else %}0%{% endif %}
        </h3>
        <p style="font-size: 1.1rem; font-weight: 500;">æ‰¾å›ç‡</p>
    </div>
</div>

<!-- ç±»åˆ«ç»Ÿè®¡ -->
<div class="card">
    <h3 style="color: #2c3e50; margin-bottom: 1.5rem; text-align: center;">ğŸ“Š ç‰©å“ç±»åˆ«ç»Ÿè®¡</h3>
    
    <div style="display: grid; gap: 1rem;">
        {% for category in lost_stats.keys() %}
        {% set lost_count = lost_stats[category] %}
        {% set found_count = found_stats[category] %}
        {% if lost_count > 0 or found_count > 0 %}
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="font-size: 2rem;">
                        {% if category == 'é’±åŒ…' %}ğŸ’°
                        {% elif category == 'é’¥åŒ™' %}ğŸ”‘
                        {% elif category == 'ä¹¦ç±' %}ğŸ“š
                        {% elif category == 'ç”µå­äº§å“' %}ğŸ“±
                        {% else %}ğŸ“¦{% endif %}
                    </div>
                    <h4 style="color: #2c3e50;">{{ category }}</h4>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 1.2rem; font-weight: bold; color: #667eea;">
                        {{ lost_count + found_count }} ä»¶
                    </div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div style="text-align: center; padding: 1rem; background: rgba(255, 154, 158, 0.1); border-radius: 8px;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: #dc3545; margin-bottom: 0.5rem;">
                        {{ lost_count }}
                    </div>
                    <div style="color: #666;">é—å¤±</div>
                </div>
                <div style="text-align: center; padding: 1rem; background: rgba(132, 250, 176, 0.1); border-radius: 8px;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: #28a745; margin-bottom: 0.5rem;">
                        {{ found_count }}
                    </div>
                    <div style="color: #666;">æ‹¾åˆ°</div>
                </div>
            </div>
            
            <!-- è¿›åº¦æ¡ -->
            <div style="margin-top: 1rem;">
                <div style="background: #e9ecef; height: 8px; border-radius: 4px; overflow: hidden;">
                    {% set total = lost_count + found_count %}
                    <div style="height: 100%; background: linear-gradient(90deg, #ff6b6b {{ (lost_count/total*100)|round(1) }}%, #51cf66 {{ (lost_count/total*100)|round(1) }}%);"></div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 0.5rem; font-size: 0.9rem; color: #666;">
                    <span>é—å¤± {{ (lost_count/total*100)|round(1) }}%</span>
                    <span>æ‹¾åˆ° {{ (found_count/total*100)|round(1) }}%</span>
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>

<!-- åœ°ç‚¹ç»Ÿè®¡ -->
{% if location_stats %}
<div class="card">
    <h3 style="color: #2c3e50; margin-bottom: 1.5rem; text-align: center;">ğŸ“ çƒ­é—¨åœ°ç‚¹ç»Ÿè®¡</h3>
    
    <div style="display: grid; gap: 1rem;">
        {% for location, stats in location_stats.items() %}
        {% set total_items = stats.lost + stats.found %}
        <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <div style="background: #667eea; color: white; width: 50px; height: 50px; 
                                border-radius: 50%; display: flex; align-items: center; 
                                justify-content: center; font-size: 1.2rem;">ğŸ“</div>
                    <h4 style="color: #2c3e50;">{{ location }}</h4>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 1.2rem; font-weight: bold; color: #667eea;">
                        {{ total_items }} ä»¶
                    </div>
                    <div style="font-size: 0.9rem; color: #666;">
                        å¤±ç‰©ä¿¡æ¯
                    </div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div style="display: flex; align-items: center; justify-content: space-between; 
                            padding: 0.8rem; background: rgba(255, 154, 158, 0.1); border-radius: 8px;">
                    <div>
                        <div style="color: #dc3545; font-weight: bold;">ğŸ” é—å¤±</div>
                    </div>
                    <div style="font-size: 1.3rem; font-weight: bold; color: #dc3545;">
                        {{ stats.lost }}
                    </div>
                </div>
                <div style="display: flex; align-items: center; justify-content: space-between; 
                            padding: 0.8rem; background: rgba(132, 250, 176, 0.1); border-radius: 8px;">
                    <div>
                        <div style="color: #28a745; font-weight: bold;">ğŸ“¦ æ‹¾åˆ°</div>
                    </div>
                    <div style="font-size: 1.3rem; font-weight: bold; color: #28a745;">
                        {{ stats.found }}
                    </div>
                </div>
            </div>
            
            <!-- çƒ­åº¦æŒ‡ç¤ºå™¨ -->
            <div style="margin-top: 1rem; text-align: center;">
                {% if total_items >= 5 %}
                    <span style="background: #ff4757; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.8rem;">
                        ğŸ”¥ çƒ­é—¨åœ°ç‚¹
                    </span>
                {% elif total_items >= 3 %}
                    <span style="background: #ffa502; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.8rem;">
                        âš¡ æ´»è·ƒåœ°ç‚¹
                    </span>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- æ¸©é¦¨æç¤º -->
<div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center;">
    <h3 style="margin-bottom: 1rem;">ğŸ’¡ æ¸©é¦¨æç¤º</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
        <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 10px;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">ğŸ“</div>
            <h4 style="margin-bottom: 0.5rem;">åŠæ—¶æ²Ÿé€š</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">
                ç•™ä¸‹æœ‰æ•ˆè”ç³»æ–¹å¼ï¼Œä¾¿äºå¤±ä¸»å’Œæ‹¾è·è€…åŠæ—¶å–å¾—è”ç³»
            </p>
        </div>
        <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 10px;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">â¤ï¸</div>
            <h4 style="margin-bottom: 0.5rem;">ä¼ é€’æ¸©æš–</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">
                æ¯ä¸€æ¬¡çš„æ‹¾é‡‘ä¸æ˜§éƒ½æ˜¯å¯¹æ ¡å›­æ–‡æ˜çš„è´¡çŒ®ï¼Œæ„Ÿè°¢æ‚¨çš„å–„ä¸¾
            </p>
        </div>
    </div>
</div>

<!-- å¿«é€Ÿæ“ä½œ -->
<div style="text-align: center; padding: 2rem 0;">
    <h3 style="color: #2c3e50; margin-bottom: 1rem;">å¿«é€Ÿæ“ä½œ</h3>
    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
        <a href="/register" class="btn">ç™»è®°å¤±ç‰©ä¿¡æ¯</a>
        <a href="/search" class="btn btn-secondary">æœç´¢æŸ¥è¯¢</a>
    </div>
</div>

<script>
    // æ·»åŠ ä¸€äº›åŠ¨æ€æ•ˆæœ
    document.addEventListener('DOMContentLoaded', function() {
        // ä¸ºç»Ÿè®¡æ•°å­—æ·»åŠ è®¡æ•°åŠ¨ç”»
        const numbers = document.querySelectorAll('[style*="font-size: 2rem"]');
        numbers.forEach(num => {
            const finalValue = parseInt(num.textContent);
            if (!isNaN(finalValue) && finalValue > 0) {
                let currentValue = 0;
                const increment = Math.ceil(finalValue / 30);
                const timer = setInterval(() => {
                    currentValue += increment;
                    if (currentValue >= finalValue) {
                        currentValue = finalValue;
                        clearInterval(timer);
                    }
                    num.textContent = currentValue;
                }, 50);
            }
        });
        
        // ä¸ºè¿›åº¦æ¡æ·»åŠ åŠ¨ç”»
        const progressBars = document.querySelectorAll('[style*="background: linear-gradient(90deg"]');
        progressBars.forEach(bar => {
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.transition = 'width 1s ease-in-out';
                bar.style.width = '100%';
            }, 500);
        });
    });
</script>
{% endblock %}5rem;">ğŸ¯</div>
            <h4 style="margin-bottom: 0.5rem;">æé«˜æ‰¾å›ç‡</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">
                è¯¦ç»†æè¿°ç‰©å“ç‰¹å¾å’Œå‡†ç¡®å¡«å†™åœ°ç‚¹ä¿¡æ¯æœ‰åŠ©äºæé«˜å¤±ç‰©æ‰¾å›æˆåŠŸç‡
            </p>
        </div>
        <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 10px;">
            <div style="font-size: 2rem; margin-bottom: 0.